- name: Test connection to Windows (using ping)
  win_ping:

# - name: Enable Remote Desktop
#   script:
#     roles/gamingvm/scripts/enable-remote-desktop.ps1


## Will potentially need other solution here (maybe using powershell)
- name: Update windows (all possible channels), reboot as many times as needed & increase reboot wait time to survive long updates
  win_updates:
    category_names: '*'
    reboot: yes
    reboot_timeout: 3600

- name: Update windows pass 2
  win_updates:
    category_names: '*'
    reboot: yes
    reboot_timeout: 3600

- name: Update windows part 3
  win_updates:
    category_names: '*'
    reboot: yes
    reboot_timeout: 3600

- name: Update windows pass 4
  win_updates:
    category_names: '*'
    reboot: yes
    reboot_timeout: 3600

# - name: Allow blank password on become
#   ansible.windows.win_regedit:
#     path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa
#     name: LimitBlankPasswordUse
#     data: 0
#     type: dword
#     state: present

# - name: Create Restore Point
#   script:
#     roles/gamingvm/scripts/create-restore-point.ps1

# - name: Remove bloatware
#   script:
#     roles/gamingvm/scripts/remove-bloatware.ps1
#   # vars:
#   #   ansible_become: true
#   #   ansible_become_method: runas
#   #   ansible_become_user: GamingVM
#   #   ansible_become_password: ''

# - name: Update Windows Store Apps
#   script:
#     roles/gamingvm/scripts/update-windows-store-apps.ps1

# - name: Wait for 10 minutes to allow windows store to update apps
#   wait_for:
#     timeout: 600
#   delegate_to: localhost

# - name: Install Apps using winget
#   script:
#     roles/gamingvm/scripts/install-apps-winget.ps1
#   vars:
#     ansible_become: true
#     ansible_become_method: runas
#     ansible_become_user: GamingVM
#     ansible_become_password: ''

# - name: Ensure Chocolatey itself is installed, using community repo for the bootstrap
#   win_chocolatey:
#     name: chocolatey

# - name: Install packages using chocolatey
#   win_chocolatey:
#     name: 

# - name: Delete all desktop icons
#   script:
#     roles/gamingvm/scripts/delete-all-desktop-icons.ps1
#   vars:
#     ansible_become: true
#     ansible_become_method: runas
#     ansible_become_user: GamingVM
#     ansible_become_password: ''

## Set startup apps
